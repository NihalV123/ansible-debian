--- 

- hosts: localhost
  connection: local
  gather_facts: false
  become: true
  
  vars:
    ansible_python_interpreter: /usr/bin/python3
    
  pre_tasks:
  - name: update repo
    apt:
        update_cache: yes
    changed_when: False
  
  tasks:
  - name: download composer
    get_url:
      url: https://getcomposer.org/installer
      dest: /tmp/installer
    tags: composer
  - name: install composer
    shell: cat /tmp/installer | php -- --install-dir=/usr/local/bin
    args:
      creates: /usr/local/bin/composer
    tags: composer
  - name: rename composer.phar to composer
    shell: mv /usr/local/bin/composer.phar /usr/local/bin/composer
    args:
      creates: /usr/local/bin/composer
    tags: composer
  - name: make composer executable
    file:
      path: /usr/local/bin/composer
      mode: a+x
      state: file
    tags: composer
  - name: install npm package globally.
    npm: name=npm global=yes
  - include: packages_debian/users.yml  
  - include: packages_debian/kali_apt.yml   
  - include: packages_debian/kali_python.yml   
  - include: packages_debian/kali_node.yml   
  - include: packages_debian/kali_docker.yml   
  - include: packages_debian/cron.yml     

        
